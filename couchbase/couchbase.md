# couchbase

`key-value`타입의 `NoSql`

기본 적으로 `json`형식을 저장된다.



https://soccerda.tistory.com/125?category=868378

https://bcho.tistory.com/934



## Node & Cluster

클러스터는 한개 이상의 노드로 구성된다.

모든 노드는 기능적으로나 인터피스티나 모두 동일하다.



노드란 하나의 카우치베이스 서버를 말한다. 이때 하나의 노드는 보통 물리적으로 구분되는 서버인 경우가 일반적이다.





## Bucket

`rdbms`에서의 `database` 같은 부분, 데이터 들이 저장된다.

버킷 별로 고유 속성을 가지고 있으며, 버킷별로 사용할 수 있는 메모리양, 옵션으로 버킷별로 접근할 수 있는 포트를 , 접근 비밀번호를 지정할 수 있다. 

한 버킷 안의 데이터와 그 안에 존재하는 뷰 등의 기능은 동일하게 동작한다.

보통 개발자는 자신의 데이터를 저장하기 위해 앱  혹은 서비스 별로 버킷을 별도로 구성한다.



하나의 앱에서 한 개 이상의 버킷을 사용할 수 있지만, join, 뷰 등의 데이터 연동에서 성능에 크게 영향을 미치므로 데이터 간의 연동이 필요없을 시에만 사용해야 한다.



하나의 클러스트에 최대 128개의 버킷 생성이 가능하며 성능상 10개를 권장



## vBucket

버킷이 실제 클러스터 노드에 저장될 때는 virtual bucket이라고 불리는 1024개로 이루어진 vBucket에 나누어 저장된다. 예를 들어 서버 노드가 4개이면 256개의 vBucket이 노드별로 존재한다.

vBucket는 서버 메모리에 존재하는 hash table이다. 실제 버킷의 데이터는 해시된 키 값에 따라 저장될 적절한 vBucket이 선정되고 다시 이 vBucket는 hash map이라는 매핑정보에 따라 실제 노드로 연결된다.



## View

view를 통해 `index`검색과 유사한 제공을 한다.

새로 갱신된 데이터에 대해서만 재인덱싱을 해서 `index`에 반영하는 방식.

뷰를 만드는 데 있어서는 `Map`과 `Reduce`를 적용할 수 있다.



원본 데이터로부터 필터링을 통하여, 원하는 형태의 데이터로 변환하여 보여준다. 읽기 전용 테이블과 유사 !

자바스크립트로된 `map&reduce`함수를 통해서 데이터를 정재한 뒤, 뷰로 만든다.

view를 이용해서 `rdbms`에서 제공되는, `indexing`, `grouping`, `sorting`등을 가능하게 한다



📘카우치베이스 실전가이드
